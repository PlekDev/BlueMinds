<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlueMinds - Neuro Play World</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/welcome.css">
    <style>
        .roadmap-banner {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 1.5rem;
            border-radius: 1.5rem;
            margin: 1.5rem 0;
            text-align: center;
            box-shadow: 0 10px 25px rgba(34, 197, 94, 0.3);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        .roadmap-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem; }
        .roadmap-activities { 
            display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap; margin-top: 1rem;
        }
        .activity-tag {
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        .recommended-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #f59e0b;
            color: white;
            font-size: 0.75rem;
            font-weight: 700;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .game-card { position: relative; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <!-- Pantalla de Bienvenida -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-card">
            <div class="welcome-logo">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <h1 class="welcome-title">¡Bienvenido a BlueMinds!</h1>
            <p class="welcome-subtitle">Plataforma de aprendizaje para niños especiales</p>
            <div class="welcome-buttons">
                <button class="btn btn-primary" onclick="goToTestSelector()">
                    <i class="fas fa-user-plus"></i>
                    Soy Nuevo Usuario
                </button>
                <button class="btn btn-secondary" onclick="showMainScreen()">
                    <i class="fas fa-sign-in-alt"></i>
                    Ya Tengo Cuenta
                </button>
            </div>
        </div>
    </div>

    <!-- Pantalla Principal -->
    <div class="main-screen" id="mainScreen" class="hidden">
        <header>
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <i class="fas fa-graduation-cap"></i>
                        <span>BlueMinds</span>
                    </div>
                    <div class="user-info">
                        <span id="userName">Hola, Niño!</span>
                        <div class="user-avatar">N</div>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <div class="container">

                <!-- ROADMAP PERSONALIZADO -->
                <div id="roadmap-section" class="hidden">
                    <div class="roadmap-banner">
                        <h3 class="roadmap-title">Tu Camino Mágico</h3>
                        <p>Eres <strong id="estilo-text">Visual</strong> • Nivel <strong id="nivel-text">Bajo</strong></p>
                        <div class="roadmap-activities" id="actividades-list">
                            <!-- Se llena con JS -->
                        </div>
                    </div>
                </div>

                <section class="progress-section">
                    <div class="progress-header">
                        <h2 class="progress-title">Progreso del día</h2>
                        <div class="progress-count">7 / 10 tareas</div>
                    </div>
                    <div class="level-path">
                        <div class="level-path-progress" style="width: 70%;"></div>
                        <div class="flag-item completed">
                            <div class="flag-circle">
                                <i class="fas fa-flag-checkered"></i>
                            </div>
                            <span class="flag-label">Inicio</span>
                        </div>
                        <div class="flag-item completed">
                            <div class="flag-circle">
                                <i class="fas fa-flag"></i>
                            </div>
                            <span class="flag-label">Nivel 1</span>
                        </div>
                        <div class="flag-item completed">
                            <div class="flag-circle">
                                <i class="fas fa-flag"></i>
                            </div>
                            <span class="flag-label">Nivel 2</span>
                        </div>
                        <div class="flag-item current">
                            <div class="flag-circle">
                                <i class="fas fa-flag"></i>
                            </div>
                            <span class="flag-label">Nivel 3</span>
                        </div>
                        <div class="flag-item">
                            <div class="flag-circle">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <span class="flag-label">Meta</span>
                        </div>
                    </div>
                </section>

                <section class="categories">
                    <div class="category-card language" onclick="animateCard(this)">
                        <div class="category-icon">
                            <i class="fas fa-language"></i>
                        </div>
                        <h3 class="category-title">Lenguaje</h3>
                        <p class="category-description">Aprende nuevas palabras y mejora tu comunicación</p>
                        <div class="category-level-path">
                            <div class="category-level-progress" style="width: 65%;"></div>
                            <div class="category-flag completed">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag completed">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag completed">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag">
                                <i class="fas fa-trophy"></i>
                            </div>
                        </div>
                        <div class="stars">
                            <i class="fas fa-star star"></i>
                            <i class="fas fa-star star"></i>
                            <i class="fas fa-star star"></i>
                            <i class="far fa-star star"></i>
                            <i class="far fa-star star"></i>
                        </div>
                    </div>

                    <div class="category-card behavior" onclick="animateCard(this)">
                        <div class="category-icon">
                            <i class="fas fa-smile"></i>
                        </div>
                        <h3 class="category-title">Conducta</h3>
                        <p class="category-description">Desarrolla habilidades sociales y emocionales</p>
                        <div class="category-level-path">
                            <div class="category-level-progress" style="width: 80%;"></div>
                            <div class="category-flag completed">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag completed">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag completed">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag completed">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag">
                                <i class="fas fa-trophy"></i>
                            </div>
                        </div>
                        <div class="stars">
                            <i class="fas fa-star star"></i>
                            <i class="fas fa-star star"></i>
                            <i class="fas fa-star star"></i>
                            <i class="fas fa-star star"></i>
                            <i class="far fa-star star"></i>
                        </div>
                    </div>

                    <div class="category-card occupational" onclick="animateCard(this)">
                        <div class="category-icon">
                            <i class="fas fa-briefcase"></i>
                        </div>
                        <h3 class="category-title">Ocupacional</h3>
                        <p class="category-description">Explora diferentes profesiones y actividades</p>
                        <div class="category-level-path">
                            <div class="category-level-progress" style="width: 45%;"></div>
                            <div class="category-flag completed">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag completed">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag">
                                <i class="fas fa-flag"></i>
                            </div>
                            <div class="category-flag">
                                <i class="fas fa-trophy"></i>
                            </div>
                        </div>
                        <div class="stars">
                            <i class="fas fa-star star"></i>
                            <i class="fas fa-star star"></i>
                            <i class="far fa-star star"></i>
                            <i class="far fa-star star"></i>
                            <i class="far fa-star star"></i>
                        </div>
                    </div>
                </section>

                <!-- Sección de Minijuegos -->
                <section class="games-section">
                    <h2 class="section-title">Minijuegos Recomendados para Ti</h2>
                    <div class="games-grid" id="games-grid">
                        <!-- Se llenan con JS -->
                    </div>
                </section>
            </div>
        </main>

        <footer>
            <div class="container">
                <div class="footer-content">
                    <p>© BlueMinds - Neuro Play World</p>
                    <div class="footer-links">
                        <a href="../index.html">Inicio</a>
                        <a href="#">Acerca de</a>
                        <a href="#">Para Padres</a>
                        <a href="#">Ayuda</a>
                        <a href="#">Términos</a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // === DATOS DE JUEGOS ===
        const games = [
            { id: 'emotion', title: 'Reconoce Emociones', desc: 'Identifica sentimientos', icon: 'fa-smile', path: '../games/emotion-game/index.html', styles: ['visual', 'kinestesico'] },
            { id: 'memory', title: 'Juego de Memoria', desc: 'Repite la secuencia', icon: 'fa-brain', path: '../games/memory-game/index.html', styles: ['auditivo'] },
            { id: 'patterns', title: 'Juego de Patrones', desc: 'Completa la secuencia', icon: 'fa-shapes', path: '../games/patterns-game/index.html', styles: ['visual', 'kinestesico', 'lectoescritura'] }
        ];

        // === CARGAR ROADMAP ===
        function loadRoadmap() {
            const roadmap = JSON.parse(localStorage.getItem('blueminds_roadmap') || 'null');
            if (!roadmap) return null;

            document.getElementById('estilo-text').textContent = roadmap.estilo;
            document.getElementById('nivel-text').textContent = roadmap.nivel_autismo;

            const actividadesHTML = roadmap.actividades.map(a => 
                `<span class="activity-tag">${a.nombre} • Nivel ${a.nivel}</span>`
            ).join('');
            document.getElementById('actividades-list').innerHTML = actividadesHTML;

            document.getElementById('roadmap-section').classList.remove('hidden');
            return roadmap;
        }

        // === MOSTRAR JUEGOS RECOMENDADOS ===
        function showRecommendedGames(estilo) {
            const recommended = games.filter(g => g.styles.includes(estilo.toLowerCase()));
            const grid = document.getElementById('games-grid');
            grid.innerHTML = '';

            recommended.forEach(g => {
                const card = document.createElement('div');
                card.className = 'game-card';
                card.innerHTML = `
                    <div class="recommended-badge">Recomendado</div>
                    <div class="game-thumbnail">
                        <i class="fas ${g.icon}"></i>
                    </div>
                    <div class="game-info">
                        <h3 class="game-title">${g.title}</h3>
                        <p class="game-description">${g.desc}</p>
                        <a href="${g.path}" class="game-button">Jugar</a>
                    </div>
                `;
                grid.appendChild(card);
            });

            // Si no hay recomendados, mostrar todos
            if (recommended.length === 0) {
                games.forEach(g => {
                    const card = document.createElement('div');
                    card.className = 'game-card';
                    card.innerHTML = `
                        <div class="game-thumbnail">
                            <i class="fas ${g.icon}"></i>
                        </div>
                        <div class="game-info">
                            <h3 class="game-title">${g.title}</h3>
                            <p class="game-description">${g.desc}</p>
                            <a href="${g.path}" class="game-button">Jugar</a>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            }
        }

        // === INICIALIZACIÓN ===
        function checkUserStatus() {
            const hasCompletedTest = localStorage.getItem('blueminds_test_completed') === 'true';
            const userType = localStorage.getItem('blueminds_user_type');

            if (hasCompletedTest && userType === 'child') {
                showMainScreen();
                document.getElementById('userName').textContent = 'Hola, Niño!';

                const roadmap = loadRoadmap();
                if (roadmap) {
                    showRecommendedGames(roadmap.estilo);
                }
            } else {
                document.getElementById('welcomeScreen').style.display = 'flex';
                document.getElementById('mainScreen').classList.add('hidden');
            }
        }

        function goToTestSelector() {
            window.location.href = 'test-selector.html';
        }

        function showMainScreen() {
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('mainScreen').classList.remove('hidden');
            setTimeout(animateMainProgress, 300);
        }

        function animateMainProgress() {
            const progressBar = document.querySelector('.level-path-progress');
            if (progressBar) {
                progressBar.style.width = '0%';
                setTimeout(() => progressBar.style.width = '70%', 300);
            }
            document.querySelectorAll('.category-level-progress').forEach((p, i) => {
                const w = p.style.width;
                p.style.width = '0%';
                setTimeout(() => p.style.width = w, 500 + i * 100);
            });
        }

        function animateCard(card) {
            card.style.transform = 'scale(0.95)';
            setTimeout(() => card.style.transform = '', 200);
        }

        document.addEventListener('DOMContentLoaded', checkUserStatus);
    </script>
</body>
</html>