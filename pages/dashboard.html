<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - BlueMinds</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/main.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container" style="margin-top: 2rem;">
        <h1 class="section-title" style="text-align:center; color:#1e40af;">Resultados de Evaluación</h1>

        <div class="feature-cards">
            <div class="feature-card">
                <div class="feature-icon" style="background:#3b82f6;"><i class="fas fa-brain"></i></div>
                <h3>Nivel Detectado</h3>
                <p class="highlight" id="nivel">—</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon" style="background:#10b981;"><i class="fas fa-eye"></i></div>
                <h3>Estilo Principal</h3>
                <p class="highlight" id="estilo">—</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon" style="background:#f59e0b;"><i class="fas fa-star"></i></div>
                <h3>Precisión</h3>
                <p class="highlight" id="precision">—%</p>
            </div>
        </div>

        <div class="card" style="margin-top:2rem;">
            <h3>Roadmap Personalizado</h3>
            <div id="roadmap" style="margin-top:1rem;"></div>
        </div>

        <div style="text-align:center; margin-top:2rem;">
            <a href="../index.html" class="game-button">Volver al Inicio</a>
        </div>
    </div>
     <script src="../api.js"></script>
 <script src="../js/auth-guard.js"></script>
    <script>
        const id = new URLSearchParams(window.location.search).get('nino') || 2;

        async function cargar() {
            const res = await fetch(`https://localhost:7001/api/dashboard/${id}`);
            const data = await res.json();

            document.getElementById('nivel').textContent = data.nivelAutismoEtiqueta;
            document.getElementById('estilo').textContent = data.estiloAprendizajePrincipal;
            document.getElementById('precision').textContent = data.nivelAutismoScore + '%';

            const roadmap = JSON.parse(data.roadmapJson);
            document.getElementById('roadmap').innerHTML = `
                <p><strong>Estilo recomendado:</strong> ${roadmap.estilo}</p>
                <ul style="margin-top:1rem; text-align:left;">
                    ${roadmap.actividades.map(a => `<li>${a.nombre} - Nivel ${a.nivel}</li>`).join('')}
                </ul>
            `;
        }

        cargar();
    </script>
</body>
</html>